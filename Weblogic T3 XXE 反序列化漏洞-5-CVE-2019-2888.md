# Weblogic T3 XXE 反序列化漏洞-CVE-2019-2888

## 漏洞原理

该漏洞点在weblogic.servlet.ejb2jsp.dd.EJBTaglibDescriptor#load方法可以解析**DocumentBuilder对象**加载XML外部实体

## 漏洞复现

复现方法同CVE-2019-2648

## 漏洞分析

调用栈

```
parse:273, DocumentBuilderImpl (com.sun.org.apache.xerces.internal.jaxp)
load:321, EJBTaglibDescriptor (weblogic.servlet.ejb2jsp.dd)
readExternal:91, EJBTaglibDescriptor (weblogic.servlet.ejb2jsp.dd)
readExternalData:1791, ObjectInputStream (java.io)
readOrdinaryObject:1750, ObjectInputStream (java.io)
readObject0:1328, ObjectInputStream (java.io)
readObject:350, ObjectInputStream (java.io)
readObject:66, InboundMsgAbbrev (weblogic.rjvm)
read:38, InboundMsgAbbrev (weblogic.rjvm)
readMsgAbbrevs:283, MsgAbbrevJVMConnection (weblogic.rjvm)
init:213, MsgAbbrevInputStream (weblogic.rjvm)
dispatch:498, MsgAbbrevJVMConnection (weblogic.rjvm)
dispatch:330, MuxableSocketT3 (weblogic.rjvm.t3)
dispatch:387, BaseAbstractMuxableSocket (weblogic.socket)
readReadySocketOnce:967, SocketMuxer (weblogic.socket)
readReadySocket:899, SocketMuxer (weblogic.socket)
processSockets:130, PosixSocketMuxer (weblogic.socket)
run:29, SocketReaderRequest (weblogic.socket)
execute:42, SocketReaderRequest (weblogic.socket)
execute:145, ExecuteThread (weblogic.kernel)
run:117, ExecuteThread (weblogic.kernel)
```

## 漏洞修复

对DocumentBuilder对象的解析设置禁止加载外部实体

## 参考

