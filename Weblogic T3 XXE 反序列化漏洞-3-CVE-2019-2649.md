# Weblogic T3 XXE 反序列化漏洞-CVE-2019-2649

## 漏洞原理

该漏洞点在weblogic.wsee.message.UnknownMsgHeader#readExternal方法可以解析**DocumentBuilder对象**加载XML外部实体

## 漏洞复现

复现方法同CVE-2019-2648

## 漏洞分析

调用栈

```
parse:116, DocumentBuilder (javax.xml.parsers)
readExternal:133, UnknownMsgHeader (weblogic.wsee.message)
readExternalData:1835, ObjectInputStream (java.io)
readOrdinaryObject:1794, ObjectInputStream (java.io)
readObject0:1348, ObjectInputStream (java.io)
readObject:370, ObjectInputStream (java.io)
readObject:66, InboundMsgAbbrev (weblogic.rjvm)
read:38, InboundMsgAbbrev (weblogic.rjvm)
readMsgAbbrevs:283, MsgAbbrevJVMConnection (weblogic.rjvm)
init:213, MsgAbbrevInputStream (weblogic.rjvm)
dispatch:498, MsgAbbrevJVMConnection (weblogic.rjvm)
dispatch:330, MuxableSocketT3 (weblogic.rjvm.t3)
dispatch:387, BaseAbstractMuxableSocket (weblogic.socket)
readReadySocketOnce:967, SocketMuxer (weblogic.socket)
readReadySocket:899, SocketMuxer (weblogic.socket)
processSockets:130, PosixSocketMuxer (weblogic.socket)
run:29, SocketReaderRequest (weblogic.socket)
execute:42, SocketReaderRequest (weblogic.socket)
execute:145, ExecuteThread (weblogic.kernel)
run:117, ExecuteThread (weblogic.kernel)
```

## 漏洞修复

对DocumentBuilder对象的解析设置禁止加载XML外部实体

## 参考

